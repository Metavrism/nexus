#!/bin/bash

# Exit on any error
set -e

# Step 1: Change the root password
echo "Changing root password..."
echo "root:yourpassword" | sudo chpasswd
if [ $? -eq 0 ]; then
  echo "Password changed successfully."
else
  echo "Failed to change password."
  exit 1
fi

# Step 2: Create and enable a 30GB swap file
echo "Creating and enabling 30GB swap file..."
sudo fallocate -l 30G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
if [ $? -eq 0 ]; then
  echo "Swap file created and enabled successfully."
else
  echo "Failed to create or enable swap file."
  exit 1
fi

# Step 3: Install Nexus CLI
echo "Installing Nexus CLI..."
curl https://cli.nexus.xyz/ | sh -s -- -y
if [ $? -eq 0 ]; then
  echo "Nexus CLI installed successfully."
else
  echo "Failed to install Nexus CLI."
  exit 1
fi

# Step 4: Source the .bashrc file
echo "Sourcing /root/.bashrc..."
source /root/.bashrc
if [ $? -eq 0 ]; then
  echo ".bashrc sourced successfully."
else
  echo "Failed to source .bashrc."
  exit 1
fi

echo "All tasks completed successfully."
